<style>
  #paintSpace {
    border: ridge 3px #BBB;
  }
  #paintMain {
    height: 80%;
    width: 100%;
    margin: 0;
    padding: 0;
  }
  #paintTools {
    display: inline-block;
    width : 73px;
    height: calc(100% - 2px);
    background-color: #EEE;
    margin: 0;
    border: ridge 2px #BBB;
    border-top: none;
    border-left: none;
  }
  #paintBackground {
    display: inline-flex;
    align-items: flex-start;
    justify-content: flex-start;
    background-color: #AAA;
    width: calc(100% - 85px);
    height: calc(100% - 10px);
    padding: 5px;
    margin: 0;
    float: right;
  }
  #colorPallet {
    width: 100%;
    height: 20%;
    background-color: #FFF;
  }
  #canvasWrap {
    display: block;
    height: 10px;
    width: 10px;
    resize: both;
    overflow: auto;
    padding-right: 5px;
    padding-bottom: 5px;
    cursor: nwse-resize;
    background-color: #DFDFDF;
    max-height: calc(80vh - 10px);
  }
  #paintCanvas {
    display: block;
    background-color: #FFF;
    cursor: crosshair;
    resize: both;
  }
  #colorPicker {
    cursor: inherit;
  }
  .colorSelection > td {
    min-height: 15px;
    min-width: 15px;
    border-top: solid 2px #AAA;
    border-left: solid 2px #AAA;
    border-bottom: solid 2px #EEE;
    border-right: solid 2px #EEE;
    cursor: pointer;
    box-shadow: 1px 1px 1px #000 inset;
  }
 #size-eg-wrap {
   display: inline-flex;
   width: 100%;
   height: 15px;
   margin: 0;
   align-items: center;
   justify-content: center;
  }
  #size-eg {
    display: inline-block;
    width: 90%;
    height: 3px;
    background-color: #333;
  }
  #size-slider {
    width: 100%;
  }
  #sizeController {
    border: inset 1px #AAA;
    margin: 2px;
  }
</style>
<div id="paintSpace">
  <div id="paintMain">
    <div id="paintTools">
    
      <div id="sizeController">
        <div id="size-eg-wrap">
          <div id="size-eg"></div>
        </div>
        <input type="range" id="size-slider" value="3" min="1" max="10" />
      </div>
    </div>
    <div id="paintBackground">
      <div id="canvasWrap" resizeable="true">
        <canvas id="paintCanvas" resizeable="true"></canvas>
      </div>
    </div>
  </div>
  <div id="colorPallet">
    <table id="pallet">
      <tr class="colorSelection">
        <td id="customColor" rowspan="2"><input type="color" id="colorPicker" value="#000000" /></td>
        <td name="black"></td>
        <td name="white"></td>
        <td name="grey"></td>
        <td name="red"></td>
        <td name="orange"></td>
        <td name="yellow"></td>
        <td name="lime"></td>
        <td name="blue"></td>
        <td name="purple"></td>
        <td name="chocolate"></td>
        <td name="hotpink"></td>
      </tr>
      <tr class="colorSelection">
        <td name="dimgrey"></td>
        <td name="whitesmoke"></td>
        <td name="lightgrey"></td>
        <td name="darkred"></td>
        <td name="brown"></td>
        <td name="darkgoldenrod"></td>
        <td name="green"></td>
        <td name="lightblue"></td>
        <td name="rebeccapurple"></td>
        <td name="burlywood"></td>
        <td name="cyan"></td>
      </tr>
    </table>
  </div>
</div>
<script>
  window.paint = {
    color : "#000",
    size : "3",
    active : false,
    mouse : {
      startx : 0,
      starty : 0
    },
    canvas : {
      width: 500,
      height: 400
    }
  };
  function standardize_color(str){
    var ctx = document.createElement("canvas").getContext("2d");
    ctx.fillStyle = str;
    var color = ctx.fillStyle;
    delete ctx;
    return color;
  }
  function setColor(code){
    window.paint.color = code;
  }
  var colorSelectionHTMLObjArray = document.querySelectorAll(".colorSelection > td");
  for(var i = 0; i < document.querySelectorAll(".colorSelection > td").length; i++){
    if(colorSelectionHTMLObjArray[i].id && colorSelectionHTMLObjArray[i].id == "customColor"){
      document.getElementById("colorPicker").onchange = function(){
        window.paint.color = this.value;
        console.log("You've selected: " + window.paint.color);
      };
    } else {
      colorSelectionHTMLObjArray[i].style.backgroundColor = colorSelectionHTMLObjArray[i].getAttribute("name");
      colorSelectionHTMLObjArray[i].innerHTML = "&nbsp;";
      colorSelectionHTMLObjArray[i].onclick = function(){
        window.paint.color = this.getAttribute("name");
        document.getElementById("colorPicker").value = standardize_color(window.paint.color);
        console.log("You've selected: " + window.paint.color);
      };
    }
  }
  var c = document.getElementById("paintCanvas");
  c.height = window.paint.canvas.height;
  c.width = window.paint.canvas.width;
  c.parentElement.style.height = window.paint.canvas.height + "px";
  c.parentElement.style.width = window.paint.canvas.width + "px";
  var ctx = c.getContext("2d");
  
  function down(e){
    window.paint.active = true;
    var x, y;
    if(e.touches && e.touches[0]){
      x = e.touches[0].clientX;
      y = e.touches[0].clientY;
    } else {
      x = e.clientX;
      y = e.clientY;
    }
    x -= c.getBoundingClientRect().left;
    y -= c.getBoundingClientRect().top;
    window.paint.mouse.startx = x;
    window.paint.mouse.starty = y;
    ctx.beginPath();
    ctx.moveTo(x, y);
  };
  function up(e){
    var x, y;
    if(e.touches && e.touches[0]){
      x = e.touches[0].clientX;
      y = e.touches[0].clientY;
    } else {
      x = e.clientX;
      y = e.clientY;
    }
    x -= c.getBoundingClientRect().left;
    y -= c.getBoundingClientRect().top;
    if(window.paint.mouse.startx == x && window.paint.mouse.starty == y){
      // draw dot
      ctx.lineWidth = window.paint.size;
      ctx.strokeStyle = window.paint.color;
      ctx.lineCap = "round";
      ctx.lineTo(x, y);
      ctx.stroke();
      ctx.closePath();
      window.paint.active = false;
    } else {
      // complete line
      ctx.closePath();
      window.paint.active = false;
    }
  };
  function move(e){
    var x, y;
    if(e.touches && e.touches[0]){
      x = e.touches[0].clientX;
      y = e.touches[0].clientY;
    } else {
      x = e.clientX;
      y = e.clientY;
    }
    x -= c.getBoundingClientRect().left;
    y -= c.getBoundingClientRect().top;
    if(window.paint.active){
      ctx.lineWidth = window.paint.size;
      ctx.strokeStyle = window.paint.color;
      ctx.lineCap = "round";
      ctx.lineTo(x, y);
      ctx.stroke();
    }
  };
  c.onmousedown = down;
  c.onmousemove = move;
  c.onmouseup = up;
  c.ontouchstart = down;
  c.ontouchmove = move;
  c.ontouchend = up;
  document.getElementById("size-slider").onchange = function(){
    window.paint.size = this.value;
    document.getElementById("size-eg").style.height = this.value + "px";
  };
  var canvasWrap = document.getElementById("canvasWrap");
  setInterval(function(){
    var cwh = parseInt(canvasWrap.style.height);
    var cww = parseInt(canvasWrap.style.width);
    if(window.paint.canvas.height != cwh || window.paint.canvas.width != cww){
      c.height = cwh;
      c.width = cww;
      window.paint.canvas.height = cwh;
      window.paint.canvas.width = cww;
    }
  }, 100);
</script>